# ORCA Analysis GUI

## Introduction
This repository contains a Graphical User Interface (GUI) designed to streamline the creation and analysis of files generated by the [ORCA computational chemistry package](https://orcaforum.kofo.mpg.de/app.php/portal). Launch the GUI by running [Launcher.py](/GUI/Launcher.py) in your preferred Python environment. 

## Prerequisites
While the [Launcher](/GUI/Launcher.py) will prompt the installation of any missing packages and automatically add them to your system's PATH, it's advisable to pre-install the required software and Python modules before using the GUI.

### External Software
Ensure the following software is installed on your system:

- **Python 3.11+**: Available from [Python Downloads](https://www.python.org/downloads/). During installation, add Python to your system's PATH and choose a convenient installation location, such as `C:\Python312`.
- **GitHub Desktop**: Available from [GitHub Desktop](https://desktop.github.com/). Installation does not require a GitHub account.
- **Git**: Available from [Git SCM](https://git-scm.com/). Install using the default settings in the suggested location, unless you have specific preferences. No GitHub account is required.

### Python modules
Install the necessary Python modules using `pip` in your command prompt:

```console
pip install importlib numpy scipy matplotlib git lxml PyQt6 pyarrow pandas openpyxl csv natsort
```

## GUI Functionality
The GUI features 13 modules designed to facilitate the analysis of ORCA output files across various common and advanced applications, organized by their functionality.

### Input to Output operations

#### 1. CREST .xyz Splitter:
This module extracts conformers and their energies identified by the [Conformerâ€“Rotamer Ensemble Sampling Tool (CREST)](https://crest-lab.github.io/crest-docs/), an exceptionally efficient program for mapping low-energy conformations of any analyte. *XYZ* coordinates of each conformer are stored in the `crest_conformers.xyz` file, which is generated upon completion of a CREST run. The `CREST .xyz splitter` module extracts each conformer to individual .gjf files (Gaussian Input format). Extracting of conformers to alternative file types will be added in future updates. 

- **Inputs:**
    - .xyz file: Specify the path and filename of `crest_conformers.xyz`. 
    - Output basename: Define the basename for exported conformer files. Each file will be suffixed with _N, where N is an integer, to ensure unique identification.
- **Outputs:**
    - Writes all conformers from `crest_conformers.xyz` to individual .gjf files in the directory `Conformers`. 
    - Writes `Energies.csv`, a file summarizing the name, energy, and relative energy of each extracted confromer for direct use with `2. Parse .gjf files by cosine sim`.

#### 2. Parse .gjf files by cosine similarity:
This module processes a directory containing a series of .gjf files (representing multiple conformations of a single analyte), or the `Energies.csv` file generated by the [CREST .xyz Splitter](#1-crest-xyz-splitter). It identifies unique conformations below a user-defined threshold based on cosine similarity and/or energy using the methods described [here](https://www.frontiersin.org/articles/10.3389/fchem.2019.00519/full).

- **Inputs:**
    -

- **3. Gaussian .gjf to ORCA .inp**: Take a directory containing a series of .gjf files and converts each .gjf to the corresponding ORCA .inp file with custom inputs determined via inputs to the GUI interface. This is exceptionally useful for generating ORCA .inp files after parsing .gjf files extracted from CREST for calculation at higher levels of quantum-chemical theory.

- **4. ORCA .out to ORCA .inp (Opt/Freq)**: Take a directory containing a series of ORCA .out files, extracts the final geometry, and writes the extracted geometry to a new ORCA .inp file with custom inputs determined via inputs to the GUI interface. This is exceptionally useful for restarting ORCA calculations on failed runs and run single-point energy evaluations on DFT-optimized geometries using high levels of quantum-chemical theory like DLPNO-CCSD(T) to name a few. 

- **5. ORCA .out to ORCA .inp (VGFC/TD-DFT)**: Take a directory containing a series of ORCA .out files, extracts the final geometry, and writes the extracted geometry to a new ORCA .inp file with custom inputs for computing UV-Vis absorption spectra using the Vertical Gradient Franck-Condon (VG|FC) method, which is sometimes called the Independent Mode Displaced Harmonic Oscillator (IMDHO) model. 

### ORCA .out analyses

- **6. Plot optimization trajectory**: Plots the energy change, SCF energy, max gradient, max step, RMS gradient, and RMS step as a function of the number of optimziation cycles for a single ORCA .out file containing the Opt keyword (or any other vairant that performs a geometry optimization).

<a name="calculate-thermochemistry"></a>
- **7. Calculate thermochemistry**: Take a directory containing a series of ORCA .out files and calculates thermochemical corrections and parition functions using the methods of [McQuarrie and Simon (1999)](https://gaussian.com/wp-content/uploads/dl/thermo.pdf) at user specified values of temperature and pressure. Users can also calculate thermochemistry using scaled vibrational frequencies if desired. Morever, users will be notified about the presence of imaginary frequencies and/or imcomplete Opt/Freq jobs. Outputs for this module include the following:
    - Filename
    - Number of imaginary freqs
    - Electronic energy
    - Thermal energy
    - Total enthalpy (H)
    - Total entropy (T * S)
    - Gibbs energy (G) 
    - A, B, and C rotational constants
    - Rotational symmetry number
    - X, Y, and Z dipole components, as well as the total dipole moment
    - Isotropic polarizability
    - Translational, rotational, vibrational, and electronic partition functions 

<a name="extract-coupled-cluster"></a>
- **8. Extract coupled cluster energies**: Takes a directory containing a series of ORCA .out files containing information from coupled cluster calculations and extracts relevant values, including:
    - Filename
    - CCSD(T) energy
    - CCSD energy
    - Triples correction
    - Correlation energy
    - T1 diagnostic (indicates whether the coupled cluster results are trustworthy)

- **9. Extract/plot IR spectra**: Takes a directory containing a series of ORCA .out files that have computed vibrational freqencies via the `Freq` keyword (or similiar). IR spectra are then calculated by applying a Gaussian convolution to each absorption (with a userspecified FWHM), and exported to an Excel file (.xlsx) along a user specified range in cm**-1 and step size. Exporting options include the following:
    - Apply a multiplicative scaling factor to all calculated vibrational frequencies (between 0 - 2)
    - Normalize spectra to a maximum value of 1
    - Create and save an additional plot of all exported spectra.

- **10. Extract/plot UV-Vis spectra (VG-FC)**: Takes a directory containing a series of .spectrum.rootN and/or .spectrum files (can be for multiple analytes!) generated Excited State Dynamics (ESD) simulations performed using ORCA and exports their spectra to an Excel file along a user specified range and energy unit (nm, cm**-1, or eV). Options:
    - **Input unit**: Specify the unit of energy of the data stored in the .spectrum / .spectrumrootN files (nm, cm**-1, or eV).
    - **Output unit**: Specify the unit of energy of that you would like your spectra to be exported as (nm, cm**-1, or eV).
    - **Export range**: Specify the range and step size for your exported spectra; default values applicable to most systems auto-update in the GUI interface. 
    - **Shift spectra**: Apply a uniform redshift/blueshift to the data in the .spectrum.rootN and .spectrum files for alignment with experimental data. Shifts can be specified in nm, cm**-1, or eV (eV reccomended due to non-liear spacing of the nm and cm**-1 scales.)
    - **Output basename**: The name that the output files will be called (no extensions or pathname)
    - **Normalize output**: Normalize spectra to a maximum value of 1
    - **Plot spectra externally**: Create and save additional plots of all exported spectra.     

### Additional analyses

- **11. Boltzmann-weight CCSs**: Calculates the ensemble-averaged CCS of an molecule by Boltzmann-weighting the CCS of each conformation according to its population. Requires:
    - **DFT Thermochem .csv**: .csv file containing DFT electronic energies and thermochemistry, which is generated from the [**7. Calculate thermochemistry**](#calculate-thermochemistry) tab. 
    - **Coupled cluster .csv**: .csv file containing CCSD(T) or CCSD energies generated from the [8. Extract coupled cluster energies](#extract-coupled-cluster) tab.
    - **CCS .csv**: .csv file containing CCSs, which is generated from the [many .mout analyzer](https://github.com/HopkinsLaboratory/MobCal-MPI) tab of the MobCal-MPI GUI.

- **12. ORCA LED analysis**: Plots the results from a Local Energy Decomposition (LED) analysis, decomposing the interaction energy between the parent molecule and its N fragments. Currently, the code supports two fragments (N = 2). Inputs:
    - 

- **13. ORCA NEB analysis**: Plots the results from a Nudged Elastic Band (NEB) analysis, including the reaction coordinate during eachNEB interation along several user-specified parameters, including reaction coordinate, atomic distances, bond angles, or dihedral angles. Exporting the *XYZ* coordinates images from a specific run and generation of an ORCA .inp from these coordinates is also supported. Implementation will be including in the next major update. Inputs:
- _trj.xyz file from a NEB calculation 

# Detailed use and examples
 
